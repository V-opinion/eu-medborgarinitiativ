function encodeUTF8(n){return encodeURIComponent(n).replace(/\+/g,"%2B")}function decodeUTF8(n){return decodeURIComponent(n.replace(/\+/g," "))}function getXMLHttpRequestObject(){return new XMLHttpRequest}function getDomDocument(){return document.implementation.createDocument("","",null)}function requestQueryString(n,t){var r,i,f,u;if(!t||(n||typeof n=="string"||(n=location.search),r=n.indexOf("?"),r==-1))return null;for(i=null,n=n.substring(r),f=new RegExp("[\\?\\&]"+t+"\\=[^&#]*","ig"),u=null;(u=f.exec(n))!=null;)i=(i==null?"":i+", ")+decodeUTF8(u[0].substring(t.length+2));return i}function getCookie(n,t){n=encodeUTF8(n);var u=document.cookie,f=new RegExp("(^|; )"+n+"\\=[^;]*","i"),i=null,r=f.exec(u);if(r==null)return null;if(i=r[0].substring(r[0].indexOf("=")+1),!t)return decodeUTF8(i);for(u=i,t=encodeUTF8(t),f=new RegExp("(^|&)"+t+"\\=[^&]*","ig"),i=null,r=null;(r=f.exec(u))!=null;)i=(i==null?"":i+", ")+r[0].substring(r[0].indexOf("=")+1);return i==null?null:decodeUTF8(i)}function setCookie(n,t,i,r){var u=SiteURL,s,a,c,h,o;u?u.substring(8).indexOf("/")>-1&&(u=u.substring(u.substring(8).indexOf("/")+8),u=u.substring(0,u.lastIndexOf("/"))):(u=new String(document.location.pathname),u=u.substring(0,u.lastIndexOf("/")),u.indexOf("/")!=0&&(u="/"+u),(u.substring(u.length-3)=="/sv"||u.substring(u.length-3)=="/fi"||u.substring(u.length-3)=="/nb")&&(u=u.substring(0,u.length-3)));u||(u="/");s="";r&&(a=new Date,c=new Date,c.setTime(a.getTime()+864e5*r),s=";expires="+c.toGMTString());var l=document.cookie,f=null,e=null;if(n=encodeUTF8(n),t=encodeUTF8(t),!i){for(f=new RegExp("(^|; )"+n+"\\=","ig");(e=f.exec(l))!=null;)o=e[0].replace(/; /g,""),o.replace(/\=/,"")!=n&&(document.cookie=o+";path="+u+";expires=Fri, 4 Mar 1980 08:19:41 UTC");document.cookie=n+"="+t+";path="+u+s;return}if(i=encodeUTF8(i),f=new RegExp("(^|; )"+n+"\\=[^;]*","i"),e=f.exec(l),e==null){document.cookie=n+"="+i+"="+t+";path="+u+s;return}for(h=e[0].substring(e[0].indexOf("=")+1),f=new RegExp("(^|&)"+i+"\\=[^&]*(&|$)","ig"),h=h.replace(f,""),document.cookie=n+"="+i+"="+t+(h?"&":"")+h+";path="+u+s,f=new RegExp("(^|; )"+n+"\\=","ig");(e=f.exec(l))!=null;)o=e[0].replace(/; /g,""),o.replace(/\=/,"")!=n&&(document.cookie=o+";path="+u+";expires=Fri, 4 Mar 1980 08:19:41 UTC")}function getXMLHttpRequest(){return new XMLHttpRequest}function HTMLEncode(n){if(!n||typeof n!="string")return n;var t=/&/g,i=/"/g,r=/</g,u=/>/g;return t.test(n)&&(n=n.replace(t,"&amp;")),i.test(n)&&(n=n.replace(i,"&quot;")),r.test(n)&&(n=n.replace(r,"&lt;")),u.test(n)&&(n=n.replace(u,"&gt;")),fixLineEndings(n)}function fixLineEndings(n){if(!n)return n;var t=/([^\r]|^)(?=\n)/g;return t.test(n)?n.replace(t,"$1\r"):n}function xPathEncode(n){return n.search(/'/)>-1?"concat('"+n.replace(/'/g,"', \"'\", '")+"')":"'"+n+"'"}function sortCase(n,t){var i=n,r=t,u;try{return(typeof i!="string"&&(i=i.toString()),typeof r!="string"&&(r=r.toString()),i=i.toLowerCase(),r=r.toLowerCase(),i==r)?0:(u=[i,r],u.sort(),u[0]==i?-1:1)}catch(f){return 0}}function getDOM(n,t){var i=getDomDocument();return i==null?null:(t?i.load(t):n&&i.loadXML(n),(i.parseError.errorCode!=0||i.xml.length==0)&&i.loadXML("<root><result>"+i.parseError.errorCode+"<\/result><resulttext>"+HTMLEncode(i.parseError.reason)+"<\/resulttext><status>"+i.parseError.errorCode+"<\/status><statustext>"+HTMLEncode(i.parseError.reason)+"<\/statustext><\/root>"),i)}async function getXMLDOMAsync(n,t="GET",i=null){var r=getXMLHttpRequest(),h,f,e,s,o;if(r==null)return null;h=n;window.DocumentVersionInformation&&n.indexOf(".ashx")!=-1&&(n+=n.indexOf("?")==-1?"?":"&",n+="DocumentVersionInformation="+DocumentVersionInformation.contentVersion);try{r.open(t,n,!0)}catch(u){return u.description?getDOM("<root><result>"+u.number+"<\/result><resulttext>"+HTMLEncode(u.description)+"<\/resulttext><status>"+u.number+"<\/status><statustext>"+HTMLEncode(u.description)+"<\/statustext><\/root>"):getDOM("<root><result>-1<\/result><resulttext>"+HTMLEncode(u)+"<\/resulttext><status>-1<\/status><statustext>"+HTMLEncode(u)+"<\/statustext><\/root>")}r.setRequestHeader("Accept","text/xml");f=null;try{await r.promiseResponse(i,!1);f=getXmlHttpXMLDocument(r)}catch(u){f=getDOM("<root><result>-1<\/result><resulttext>Could not connect to web server.<\/resulttext><status>-1<\/status><statustext>Could not connect to web server.<\/statustext><\/root>")}if(n=h,!f.xml)return getDOM("<root><result>"+r.status+"<\/result><resulttext>"+HTMLEncode(r.statusText)+"<\/resulttext><status>"+r.status+"<\/status><statustext>"+HTMLEncode(r.statusText)+"<\/statustext><\/root>",null);try{if(e=f.documentElement.selectSingleNode("status"),e){if(s=e.text,s=="-7"&&!XMLHttpRequest.hasRenewedSession)return XMLHttpRequest.hasRenewedSession=!0,await getXMLDOMAsync(n,t,i);if(s=="-10"&&window.DocumentVersionInformation&&GlobalEditTemplateFocusTimeoutId!=-1){if(GlobalEditTemplateFocusTimeoutId>0&&window.clearTimeout(GlobalEditTemplateFocusTimeoutId),GlobalEditTemplateFocusTimeoutId=-1,o=await showConfirmReloadDialog(),GlobalEditTemplateFocusTimeoutId=-2,o&&!o.reload)return window.DocumentVersionInformation.contentVersion=0,window.setTimeout(function(){GlobalEditTemplateFocusTimeoutId=0},1e3),await getXMLDOMAsync(n,t,i);o&&o.reload?(window.detachEvent?window.detachEvent("onbeforeunload",onBeforeEditTemplateUnloadAsync):window.removeEventListener("beforeunload",onBeforeEditTemplateUnloadAsync,!1),location.replace(location.href)):window.setTimeout(function(){GlobalEditTemplateFocusTimeoutId=0},1e3)}}XMLHttpRequest.hasRenewedSession=!1;window.DocumentVersionInformation&&(e=f.documentElement.selectSingleNode("DocumentVersionInformation"),e&&(DocumentVersionInformation.contentVersion=parseInt(e.getAttribute("contentVersion"))))}catch(u){}return f}function selectSingleNode(n){var t=null;return t=this.ownerDocument?this.ownerDocument.evaluate(n,this,nsResolver,XPathResult.ANY_TYPE,null):this.evaluate(n,this,nsResolver,XPathResult.ANY_TYPE,null),t.iterateNext()}function selectNodes(n){var r=null,t,i;for(r=this.ownerDocument?this.ownerDocument.evaluate(n,this,nsResolver,XPathResult.ANY_TYPE,null):this.evaluate(n,this,nsResolver,XPathResult.ANY_TYPE,null),t=[],i=null;(i=r.iterateNext())!=null;)t[t.length]=i;return t}function loadXML(n){for(var t=this,f=new DOMParser,r=f.parseFromString(n,"text/xml"),i,u;t.hasChildNodes();)t.removeChild(t.lastChild);for(i=0;i<r.childNodes.length;i++)u=t.importNode(r.childNodes[i],!0),t.appendChild(u)}function nsResolver(n){for(var t=0;t<MozillaSelectionNameSpaceArr.length;t++)if(MozillaSelectionNameSpaceArr[t][0]==n)return MozillaSelectionNameSpaceArr[t][1];return null}function buildDOMForMozilla(){window.XMLDocument&&XMLDocument.prototype.getElementsByTagName&&(XMLDocument.prototype.__defineGetter__("parseError",function(){var n=this.getElementsByTagName("parsererror"),t=n.length==0?0:-1,i=n.length==0?"":n[0].textContent;return{errorCode:t,reason:i}}),XMLDocument.prototype.setProperty=function(n,t){switch(n){case"SelectionNamespaces":var i=null;(i=/xmlns\:(\w+)\=['"]([\s\S]+?)['"]/.exec(t)!=null)&&(MozillaSelectionNameSpaceArr[MozillaSelectionNameSpaceArr.length]=[i[1],i[2]]);break;default:throw"Invalid or unrecognised property";}},XMLDocument.prototype.loadXML=loadXML,XMLDocument.prototype.load=async function(n){for(var r=await getXMLDOMAsync(n,"GET",null),t=this,i,u;t.hasChildNodes();)t.removeChild(t.lastChild);for(i=0;i<r.childNodes.length;i++)u=t.importNode(r.childNodes[i],!0),t.appendChild(u)},buildNodeForMozilla(XMLDocument),buildNodeForMozilla(Element),Text.prototype.__defineGetter__("text",nodeGetText),Text.prototype.__defineSetter__("text",nodeSetText),Text.prototype.__defineGetter__("xml",_Node_getXML),buildAttributeForMozilla())}function _Node_getXML(){var n=new XMLSerializer;return n.serializeToString(this)}function buildNodeForMozilla(n){n.prototype.selectSingleNode=selectSingleNode;n.prototype.selectNodes=selectNodes;n.prototype.__defineGetter__("xml",_Node_getXML);n.prototype.__defineGetter__("text",nodeGetText);n.prototype.__defineSetter__("text",nodeSetText);n.prototype.transformNode=function(n){var t=new XSLTProcessor;t.importStylesheet(n);var i=t.transformToDocument(this),r=new XMLSerializer;return r.serializeToString(i)};n.prototype.transformNodeToObject=function(n,t){t.loadXML(this.transformNode(n))}}function nodeGetText(){return this.textContent}function nodeSetText(n){this.nodeValue==null?this.textContent=n:this.nodeValue=n}function buildAttributeForMozilla(){Attr.prototype.__defineGetter__("text",nodeGetText);Attr.prototype.__defineSetter__("text",nodeSetText);Attr.prototype.__defineGetter__("xml",function(){return this.nodeName+'="'+this.text+'"'})}function showResultText(n,t){var i=getDOM("<root><status>"+n+"<\/status><statustext>"+HTMLEncode(t)+"<\/statustext><\/root>");return showResult(i)}function showResult(n){return showResultEx(n)==0}function showResultEx(n,t){var r=0,f="",i,o,s,e,u,h,c;if(n.documentElement==null)return 0;if(i=n.documentElement.selectSingleNode("status"),o=null,i&&(r=parseInt(i.text),o=i.getAttribute("parsed")),i=n.documentElement.selectSingleNode("statustext"),i&&(f=i.text),i=n.documentElement.selectSingleNode("result"),i&&(r=parseInt(i.text)),i=n.documentElement.selectSingleNode("resulttext"),i&&(f=i.text),i=n.documentElement.selectSingleNode("statusfulltext"),i&&(f=i.text),i=n.documentElement.selectSingleNode("resultfulltext"),i&&(f=i.text),r==0)return r;if(r>999&&r<3e3&&o!="1"){s=Lang;e="";try{e=top.location.toString()}catch(l){e=location.toString()}try{AdminURL.length>0&&e.indexOf(AdminURL)==0&&(s="",u=e.substring(AdminURL.length),u.indexOf("/")>-1&&(u=u.substring(0,u.indexOf("/")),s=u))}catch(l){}}if(typeof t=="string"){h=t.split(", ");for(c in h)if(parseInt(h[c])==r)return r}return r!=-10&&raiseCSError(f,r,window.CategoryID,window.DocumentID),r}function CSF_hasUserPermission(n,t,i){var r=0,u,f,o;try{switch(t.toUpperCase()){case"R":break;case"U":break;case"C":break;case"D":break;default:return raiseCSError("Invalid containertype"),!1}}catch(e){return raiseCSError("Invalid argument 'type' \n"+e),!1}try{switch(i.toLowerCase()){case"browse":r=1;break;case"read":r=2;break;case"write":r=4;break;case"create":r=8;break;case"delete":r=16;break;case"sendforrevision":r=32;break;case"removefromrevision":r=64;break;case"reject":r=128;break;case"approve":r=256;break;case"readcontainer":r=512;break;case"writecontainer":r=1024;break;case"createcontainer":r=2048;break;case"deletecontainer":r=4096;break;case"setowner":r=8192;break;case"admin":r=8388608;break;case"default":return raiseCSError("Invalid permission name '"+i+"'"),!1}}catch(e){return raiseCSError("Invalid argument 'namedPermission' \n"+e),!1}return(u="WebAPI/ContentStudio_Security_AccessControl.ashx?Action=ObjectAccessCheck&ObjectId="+n+"&ObjectType="+t+"&AccessMask="+r,u=getAdminURL(u),f=getXMLDOMAsync(u,"GET",null),!showResult(f))?!1:(o=f.documentElement.selectSingleNode("access[.='grant']"),o==null)?!1:!0}function getAdminURL(n){typeof n!="string"&&(n="");return AdminURL+Lang+n}function CSF_OpenWindow(n,t){return window.open(n.href,t),!1}function getXmlHttpXMLDocument(n){var t=n.responseXML;return t instanceof XMLDocument||(t=getDOM(n.responseText)),t}function documentInformation(n,t){var o=DocumentId,s=PresentationTemplateId,h=EditId,c=RefId,r,u,f,e,i;if(n&&(n.indexOf(":")==-1||n.indexOf("//")>-1)){try{if(r=this.xmlHttp=getXMLHttpRequestObject(),n.indexOf("#")!=-1&&(n=n.substring(0,n.indexOf("#"))),n+=n.indexOf("?")==-1?"?CS_GetResolveInformation=1":"&CS_GetResolveInformation=1",u=!1,f=this,t&&(r.onreadystatechange=function(){r.readyState==4&&(f.callback(r),t.call(f,f))},u=!0),r.open("GET",n,u),r.send(),e=null,u||r.status!=200||(e=r.getResponseHeader("Content-Type"))==null||e.toLowerCase()!="text/xml")i=requestQueryString(n,"id"),i&&(o=parseInt(i)),i=requestQueryString(n,"editid"),i&&(h=parseInt(i)),i=requestQueryString(n,"ptid"),i&&(s=parseInt(i)),i=requestQueryString(n,"refid"),i&&(c=parseInt(i));else{this.callback(r);return}}catch(l){}u||(this.xmlHttp=null)}this.documentId=o;this.documentPath=n;this.documentUrl=n;this.editId=h;this.presentationTemplateId=s;this.refId=c}function attachToCSEvent(n,t){for(var f,i,e=n.split(/\s+/),r=!0,u=0;u<e.length;u++)f=e[u],i=!1,document.addEventListener?i=document.addEventListener(f,t,!1):document.attachEvent("onpropertychange",function(n){n.propertyName==f&&(i=t(n))}),typeof i=="boolean"&&(r=r&&i);return r}function dispatchCSEvent(n,t,i){var u=new CustomEvent(n,{bubbles:!1,cancelable:t,detail:i}),r=document.dispatchEvent(u);return r&&frameElement&&(r=frameElement.dispatchEvent(u)),r}function raiseCSError(n,t,i,r,u){var o=function(n){this.message=n},f,e;return o.prototype={message:"",number:0,documentId:0,categoryId:0,eptField:null},f=new o(n),t&&(t=parseInt(t),t>0&&(n="("+t+") "+n),f.number=t),i&&(f.categoryId=parseInt(i)),r&&(f.documentId=parseInt(r)),u&&(f.eptField=u),e=dispatchCSEvent("cserror",!0,f),e&&alert(n),e}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.invalidXMLCharsRe=/[\cA-\cI\cO-\cZ]/g;String.prototype.removeInvalidXMLChars=function(){return this.replace(this.invalidXMLCharsRe,"")};var MozillaSelectionNameSpaceArr=[];buildDOMForMozilla();XMLHttpRequest.hasRenewedSession=!1;XMLHttpRequest.pendingResponses=Promise.resolve();XMLHttpRequest.pendingResponseState=function(){const t={status:"pending"};let n=XMLHttpRequest.pendingResponses;return n?Promise.race([n,t]).then(n=>n===t?n:{status:"fulfilled",value:n},n=>({status:"rejected",reason:n})):new n({status:"notstarted"})};XMLHttpRequest.prototype.promiseResponse=async function(n=null,t=true){let i=this,u=!1;const f=()=>new Promise((r,f)=>{i.onload=function(){dispatchCSEvent("asyncloadend",!1,i);t&&(i.status<200||i.status>=300)?f({request:i}):(u&&enableInputs(),r(i))},i.onerror=function(n){u&&enableInputs();dispatchCSEvent("asyncloadend",!1,i);f({request:i,ev:n})},dispatchCSEvent("asyncloadstart",!0,i)||f({request:i,message:"asyncloadstartwas cancelled"}),window.IsCheckedOut&&(u=!0,disableInputs(!0)),i.send(n?.removeInvalidXMLChars())});let r=XMLHttpRequest.pendingResponses,e=await XMLHttpRequest.pendingResponseState();r=e.status!="pending"?f():r.then(f,f);XMLHttpRequest.pendingResponses=r;await r};documentInformation.prototype={documentId:0,documentPath:"",guoid:"",documentUrl:"",editId:0,presentationTemplateId:0,refId:0,versionNumber:0,documentType:"",contentType:"",categoryId:"",xmlHttp:null,abort:function(){this.xmlHttp&&(this.xmlHttp.abort(),this.xmlHttp=null)},callback:function(n){if(n.status!=200){this.xmlHttp=null;return}var i=getXmlHttpXMLDocument(n),t=i.selectSingleNode("/*/identifier/@documentid");t&&(dId=parseInt(t.text,10));t=i.selectSingleNode("/*/identifier/@editid");t&&(eId=parseInt(t.text,10));t=i.selectSingleNode("/*/identifier/@presentationtemplateid");t&&(pId=parseInt(t.tex,10));t=i.selectSingleNode("/*/identifier/@refid");t&&(rId=parseInt(t.text,10));this.documentId=dId;this.editId=eId;this.presentationTemplateId=pId;this.refId=rId;t=i.selectSingleNode("/*/identifier/@documentpath");t&&(this.documentPath=t.text);t=i.selectSingleNode("/*/identifier/@guoid");t&&(this.guoid=t.text);t=i.selectSingleNode("/*/identifier/@documenturl");t&&(this.documentUrl=t.text);t=i.selectSingleNode("/*/identifier/@versionnumber");t&&(this.versionNumber=parseInt(t.text,10));t=i.selectSingleNode("/*/identifier/@documenttype");t&&(this.documentType=t.text);t=i.selectSingleNode("/*/identifier/@contenttype");t&&(this.contentType=t.text);t=i.selectSingleNode("/*/identifier/@categoryid");t&&(this.categoryId=parseInt(t.text,10));this.xmlHttp=null}};
//# sourceMappingURL=global.async.min.js.map